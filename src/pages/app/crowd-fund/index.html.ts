// metadata
export const version = "0.8.26"
export const title = "Crowd Fund"
export const description = "An example of crowd funding contract"
export const cyfrinLink =
  "https://www.cyfrin.io/glossary/crowd-fund-solidity-code-example"

export const keywords = ["app", "application", "crowd", "fund", "funding"]

export const codes = [
  {
    fileName: "CrowdFund.sol",
    code: "Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVApwcmFnbWEgc29saWRpdHkgXjAuOC4yNjsKCmludGVyZmFjZSBJRVJDMjAgewogICAgZnVuY3Rpb24gdHJhbnNmZXIoYWRkcmVzcywgdWludDI1NikgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiB0cmFuc2ZlckZyb20oYWRkcmVzcywgYWRkcmVzcywgdWludDI1NikgZXh0ZXJuYWwgcmV0dXJucyAoYm9vbCk7Cn0KCmNvbnRyYWN0IENyb3dkRnVuZCB7CiAgICBldmVudCBMYXVuY2goCiAgICAgICAgdWludDI1NiBpZCwKICAgICAgICBhZGRyZXNzIGluZGV4ZWQgY3JlYXRvciwKICAgICAgICB1aW50MjU2IGdvYWwsCiAgICAgICAgdWludDMyIHN0YXJ0QXQsCiAgICAgICAgdWludDMyIGVuZEF0CiAgICApOwogICAgZXZlbnQgQ2FuY2VsKHVpbnQyNTYgaWQpOwogICAgZXZlbnQgUGxlZGdlKHVpbnQyNTYgaW5kZXhlZCBpZCwgYWRkcmVzcyBpbmRleGVkIGNhbGxlciwgdWludDI1NiBhbW91bnQpOwogICAgZXZlbnQgVW5wbGVkZ2UodWludDI1NiBpbmRleGVkIGlkLCBhZGRyZXNzIGluZGV4ZWQgY2FsbGVyLCB1aW50MjU2IGFtb3VudCk7CiAgICBldmVudCBDbGFpbSh1aW50MjU2IGlkKTsKICAgIGV2ZW50IFJlZnVuZCh1aW50MjU2IGlkLCBhZGRyZXNzIGluZGV4ZWQgY2FsbGVyLCB1aW50MjU2IGFtb3VudCk7CgogICAgc3RydWN0IENhbXBhaWduIHsKICAgICAgICAvLyBDcmVhdG9yIG9mIGNhbXBhaWduCiAgICAgICAgYWRkcmVzcyBjcmVhdG9yOwogICAgICAgIC8vIEFtb3VudCBvZiB0b2tlbnMgdG8gcmFpc2UKICAgICAgICB1aW50MjU2IGdvYWw7CiAgICAgICAgLy8gVG90YWwgYW1vdW50IHBsZWRnZWQKICAgICAgICB1aW50MjU2IHBsZWRnZWQ7CiAgICAgICAgLy8gVGltZXN0YW1wIG9mIHN0YXJ0IG9mIGNhbXBhaWduCiAgICAgICAgdWludDMyIHN0YXJ0QXQ7CiAgICAgICAgLy8gVGltZXN0YW1wIG9mIGVuZCBvZiBjYW1wYWlnbgogICAgICAgIHVpbnQzMiBlbmRBdDsKICAgICAgICAvLyBUcnVlIGlmIGdvYWwgd2FzIHJlYWNoZWQgYW5kIGNyZWF0b3IgaGFzIGNsYWltZWQgdGhlIHRva2Vucy4KICAgICAgICBib29sIGNsYWltZWQ7CiAgICB9CgogICAgSUVSQzIwIHB1YmxpYyBpbW11dGFibGUgdG9rZW47CiAgICAvLyBUb3RhbCBjb3VudCBvZiBjYW1wYWlnbnMgY3JlYXRlZC4KICAgIC8vIEl0IGlzIGFsc28gdXNlZCB0byBnZW5lcmF0ZSBpZCBmb3IgbmV3IGNhbXBhaWducy4KICAgIHVpbnQyNTYgcHVibGljIGNvdW50OwogICAgLy8gTWFwcGluZyBmcm9tIGlkIHRvIENhbXBhaWduCiAgICBtYXBwaW5nKHVpbnQyNTYgPT4gQ2FtcGFpZ24pIHB1YmxpYyBjYW1wYWlnbnM7CiAgICAvLyBNYXBwaW5nIGZyb20gY2FtcGFpZ24gaWQgPT4gcGxlZGdlciA9PiBhbW91bnQgcGxlZGdlZAogICAgbWFwcGluZyh1aW50MjU2ID0+IG1hcHBpbmcoYWRkcmVzcyA9PiB1aW50MjU2KSkgcHVibGljIHBsZWRnZWRBbW91bnQ7CgogICAgY29uc3RydWN0b3IoYWRkcmVzcyBfdG9rZW4pIHsKICAgICAgICB0b2tlbiA9IElFUkMyMChfdG9rZW4pOwogICAgfQoKICAgIGZ1bmN0aW9uIGxhdW5jaCh1aW50MjU2IF9nb2FsLCB1aW50MzIgX3N0YXJ0QXQsIHVpbnQzMiBfZW5kQXQpIGV4dGVybmFsIHsKICAgICAgICByZXF1aXJlKF9zdGFydEF0ID49IGJsb2NrLnRpbWVzdGFtcCwgInN0YXJ0IGF0IDwgbm93Iik7CiAgICAgICAgcmVxdWlyZShfZW5kQXQgPj0gX3N0YXJ0QXQsICJlbmQgYXQgPCBzdGFydCBhdCIpOwogICAgICAgIHJlcXVpcmUoX2VuZEF0IDw9IGJsb2NrLnRpbWVzdGFtcCArIDkwIGRheXMsICJlbmQgYXQgPiBtYXggZHVyYXRpb24iKTsKCiAgICAgICAgY291bnQgKz0gMTsKICAgICAgICBjYW1wYWlnbnNbY291bnRdID0gQ2FtcGFpZ24oewogICAgICAgICAgICBjcmVhdG9yOiBtc2cuc2VuZGVyLAogICAgICAgICAgICBnb2FsOiBfZ29hbCwKICAgICAgICAgICAgcGxlZGdlZDogMCwKICAgICAgICAgICAgc3RhcnRBdDogX3N0YXJ0QXQsCiAgICAgICAgICAgIGVuZEF0OiBfZW5kQXQsCiAgICAgICAgICAgIGNsYWltZWQ6IGZhbHNlCiAgICAgICAgfSk7CgogICAgICAgIGVtaXQgTGF1bmNoKGNvdW50LCBtc2cuc2VuZGVyLCBfZ29hbCwgX3N0YXJ0QXQsIF9lbmRBdCk7CiAgICB9CgogICAgZnVuY3Rpb24gY2FuY2VsKHVpbnQyNTYgX2lkKSBleHRlcm5hbCB7CiAgICAgICAgQ2FtcGFpZ24gbWVtb3J5IGNhbXBhaWduID0gY2FtcGFpZ25zW19pZF07CiAgICAgICAgcmVxdWlyZShjYW1wYWlnbi5jcmVhdG9yID09IG1zZy5zZW5kZXIsICJub3QgY3JlYXRvciIpOwogICAgICAgIHJlcXVpcmUoYmxvY2sudGltZXN0YW1wIDwgY2FtcGFpZ24uc3RhcnRBdCwgInN0YXJ0ZWQiKTsKCiAgICAgICAgZGVsZXRlIGNhbXBhaWduc1tfaWRdOwogICAgICAgIGVtaXQgQ2FuY2VsKF9pZCk7CiAgICB9CgogICAgZnVuY3Rpb24gcGxlZGdlKHVpbnQyNTYgX2lkLCB1aW50MjU2IF9hbW91bnQpIGV4dGVybmFsIHsKICAgICAgICBDYW1wYWlnbiBzdG9yYWdlIGNhbXBhaWduID0gY2FtcGFpZ25zW19pZF07CiAgICAgICAgcmVxdWlyZShibG9jay50aW1lc3RhbXAgPj0gY2FtcGFpZ24uc3RhcnRBdCwgIm5vdCBzdGFydGVkIik7CiAgICAgICAgcmVxdWlyZShibG9jay50aW1lc3RhbXAgPD0gY2FtcGFpZ24uZW5kQXQsICJlbmRlZCIpOwoKICAgICAgICBjYW1wYWlnbi5wbGVkZ2VkICs9IF9hbW91bnQ7CiAgICAgICAgcGxlZGdlZEFtb3VudFtfaWRdW21zZy5zZW5kZXJdICs9IF9hbW91bnQ7CiAgICAgICAgdG9rZW4udHJhbnNmZXJGcm9tKG1zZy5zZW5kZXIsIGFkZHJlc3ModGhpcyksIF9hbW91bnQpOwoKICAgICAgICBlbWl0IFBsZWRnZShfaWQsIG1zZy5zZW5kZXIsIF9hbW91bnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVucGxlZGdlKHVpbnQyNTYgX2lkLCB1aW50MjU2IF9hbW91bnQpIGV4dGVybmFsIHsKICAgICAgICBDYW1wYWlnbiBzdG9yYWdlIGNhbXBhaWduID0gY2FtcGFpZ25zW19pZF07CiAgICAgICAgcmVxdWlyZShibG9jay50aW1lc3RhbXAgPD0gY2FtcGFpZ24uZW5kQXQsICJlbmRlZCIpOwoKICAgICAgICBjYW1wYWlnbi5wbGVkZ2VkIC09IF9hbW91bnQ7CiAgICAgICAgcGxlZGdlZEFtb3VudFtfaWRdW21zZy5zZW5kZXJdIC09IF9hbW91bnQ7CiAgICAgICAgdG9rZW4udHJhbnNmZXIobXNnLnNlbmRlciwgX2Ftb3VudCk7CgogICAgICAgIGVtaXQgVW5wbGVkZ2UoX2lkLCBtc2cuc2VuZGVyLCBfYW1vdW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBjbGFpbSh1aW50MjU2IF9pZCkgZXh0ZXJuYWwgewogICAgICAgIENhbXBhaWduIHN0b3JhZ2UgY2FtcGFpZ24gPSBjYW1wYWlnbnNbX2lkXTsKICAgICAgICByZXF1aXJlKGNhbXBhaWduLmNyZWF0b3IgPT0gbXNnLnNlbmRlciwgIm5vdCBjcmVhdG9yIik7CiAgICAgICAgcmVxdWlyZShibG9jay50aW1lc3RhbXAgPiBjYW1wYWlnbi5lbmRBdCwgIm5vdCBlbmRlZCIpOwogICAgICAgIHJlcXVpcmUoY2FtcGFpZ24ucGxlZGdlZCA+PSBjYW1wYWlnbi5nb2FsLCAicGxlZGdlZCA8IGdvYWwiKTsKICAgICAgICByZXF1aXJlKCFjYW1wYWlnbi5jbGFpbWVkLCAiY2xhaW1lZCIpOwoKICAgICAgICBjYW1wYWlnbi5jbGFpbWVkID0gdHJ1ZTsKICAgICAgICB0b2tlbi50cmFuc2ZlcihjYW1wYWlnbi5jcmVhdG9yLCBjYW1wYWlnbi5wbGVkZ2VkKTsKCiAgICAgICAgZW1pdCBDbGFpbShfaWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlZnVuZCh1aW50MjU2IF9pZCkgZXh0ZXJuYWwgewogICAgICAgIENhbXBhaWduIG1lbW9yeSBjYW1wYWlnbiA9IGNhbXBhaWduc1tfaWRdOwogICAgICAgIHJlcXVpcmUoYmxvY2sudGltZXN0YW1wID4gY2FtcGFpZ24uZW5kQXQsICJub3QgZW5kZWQiKTsKICAgICAgICByZXF1aXJlKGNhbXBhaWduLnBsZWRnZWQgPCBjYW1wYWlnbi5nb2FsLCAicGxlZGdlZCA+PSBnb2FsIik7CgogICAgICAgIHVpbnQyNTYgYmFsID0gcGxlZGdlZEFtb3VudFtfaWRdW21zZy5zZW5kZXJdOwogICAgICAgIHBsZWRnZWRBbW91bnRbX2lkXVttc2cuc2VuZGVyXSA9IDA7CiAgICAgICAgdG9rZW4udHJhbnNmZXIobXNnLnNlbmRlciwgYmFsKTsKCiAgICAgICAgZW1pdCBSZWZ1bmQoX2lkLCBtc2cuc2VuZGVyLCBiYWwpOwogICAgfQp9Cg==",
  },
]

const html = `<p>Crowd fund ERC20 token</p>
<ol>
<li>User creates a campaign.</li>
<li>Users can pledge, transferring their token to a campaign.</li>
<li>After the campaign ends, campaign creator can claim the funds if total amount pledged is more than the campaign goal.</li>
<li>Otherwise, campaign did not reach it&#39;s goal, users can withdraw their pledge.</li>
</ol>
<pre><code class="language-solidity"><span class="hljs-comment">// SPDX-License-Identifier: MIT</span>
<span class="hljs-meta"><span class="hljs-keyword">pragma</span> <span class="hljs-keyword">solidity</span> ^0.8.26;</span>

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IERC20</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transfer</span>(<span class="hljs-params"><span class="hljs-keyword">address</span>, <span class="hljs-keyword">uint256</span></span>) <span class="hljs-title"><span class="hljs-keyword">external</span></span> <span class="hljs-title"><span class="hljs-keyword">returns</span></span> (<span class="hljs-params"><span class="hljs-keyword">bool</span></span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transferFrom</span>(<span class="hljs-params"><span class="hljs-keyword">address</span>, <span class="hljs-keyword">address</span>, <span class="hljs-keyword">uint256</span></span>) <span class="hljs-title"><span class="hljs-keyword">external</span></span> <span class="hljs-title"><span class="hljs-keyword">returns</span></span> (<span class="hljs-params"><span class="hljs-keyword">bool</span></span>)</span>;
}

<span class="hljs-class"><span class="hljs-keyword">contract</span> <span class="hljs-title">CrowdFund</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">event</span> <span class="hljs-title">Launch</span>(<span class="hljs-params">
        <span class="hljs-keyword">uint256</span> id,
        <span class="hljs-keyword">address</span> <span class="hljs-keyword">indexed</span> creator,
        <span class="hljs-keyword">uint256</span> goal,
        <span class="hljs-keyword">uint32</span> startAt,
        <span class="hljs-keyword">uint32</span> endAt
    </span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">event</span> <span class="hljs-title">Cancel</span>(<span class="hljs-params"><span class="hljs-keyword">uint256</span> id</span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">event</span> <span class="hljs-title">Pledge</span>(<span class="hljs-params"><span class="hljs-keyword">uint256</span> <span class="hljs-keyword">indexed</span> id, <span class="hljs-keyword">address</span> <span class="hljs-keyword">indexed</span> caller, <span class="hljs-keyword">uint256</span> amount</span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">event</span> <span class="hljs-title">Unpledge</span>(<span class="hljs-params"><span class="hljs-keyword">uint256</span> <span class="hljs-keyword">indexed</span> id, <span class="hljs-keyword">address</span> <span class="hljs-keyword">indexed</span> caller, <span class="hljs-keyword">uint256</span> amount</span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">event</span> <span class="hljs-title">Claim</span>(<span class="hljs-params"><span class="hljs-keyword">uint256</span> id</span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">event</span> <span class="hljs-title">Refund</span>(<span class="hljs-params"><span class="hljs-keyword">uint256</span> id, <span class="hljs-keyword">address</span> <span class="hljs-keyword">indexed</span> caller, <span class="hljs-keyword">uint256</span> amount</span>)</span>;

    <span class="hljs-keyword">struct</span> <span class="hljs-title">Campaign</span> {
        <span class="hljs-comment">// Creator of campaign</span>
        <span class="hljs-keyword">address</span> creator;
        <span class="hljs-comment">// Amount of tokens to raise</span>
        <span class="hljs-keyword">uint256</span> goal;
        <span class="hljs-comment">// Total amount pledged</span>
        <span class="hljs-keyword">uint256</span> pledged;
        <span class="hljs-comment">// Timestamp of start of campaign</span>
        <span class="hljs-keyword">uint32</span> startAt;
        <span class="hljs-comment">// Timestamp of end of campaign</span>
        <span class="hljs-keyword">uint32</span> endAt;
        <span class="hljs-comment">// True if goal was reached and creator has claimed the tokens.</span>
        <span class="hljs-keyword">bool</span> claimed;
    }

    IERC20 <span class="hljs-keyword">public</span> <span class="hljs-keyword">immutable</span> token;
    <span class="hljs-comment">// Total count of campaigns created.</span>
    <span class="hljs-comment">// It is also used to generate id for new campaigns.</span>
    <span class="hljs-keyword">uint256</span> <span class="hljs-keyword">public</span> count;
    <span class="hljs-comment">// Mapping from id to Campaign</span>
    <span class="hljs-keyword">mapping</span>(<span class="hljs-keyword">uint256</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> Campaign) <span class="hljs-keyword">public</span> campaigns;
    <span class="hljs-comment">// Mapping from campaign id =&gt; pledger =&gt; amount pledged</span>
    <span class="hljs-keyword">mapping</span>(<span class="hljs-keyword">uint256</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">mapping</span>(<span class="hljs-keyword">address</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">uint256</span>)) <span class="hljs-keyword">public</span> pledgedAmount;

    <span class="hljs-function"><span class="hljs-keyword">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">address</span> _token</span>) </span>{
        token <span class="hljs-operator">=</span> IERC20(_token);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">launch</span>(<span class="hljs-params"><span class="hljs-keyword">uint256</span> _goal, <span class="hljs-keyword">uint32</span> _startAt, <span class="hljs-keyword">uint32</span> _endAt</span>) <span class="hljs-title"><span class="hljs-keyword">external</span></span> </span>{
        <span class="hljs-built_in">require</span>(_startAt <span class="hljs-operator">&gt;</span><span class="hljs-operator">=</span> <span class="hljs-built_in">block</span>.<span class="hljs-built_in">timestamp</span>, <span class="hljs-string">"start at &lt; now"</span>);
        <span class="hljs-built_in">require</span>(_endAt <span class="hljs-operator">&gt;</span><span class="hljs-operator">=</span> _startAt, <span class="hljs-string">"end at &lt; start at"</span>);
        <span class="hljs-built_in">require</span>(_endAt <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> <span class="hljs-built_in">block</span>.<span class="hljs-built_in">timestamp</span> <span class="hljs-operator">+</span> <span class="hljs-number">90</span> <span class="hljs-literal">days</span>, <span class="hljs-string">"end at &gt; max duration"</span>);

        count <span class="hljs-operator">+</span><span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
        campaigns[count] <span class="hljs-operator">=</span> Campaign({
            creator: <span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>,
            goal: _goal,
            pledged: <span class="hljs-number">0</span>,
            startAt: _startAt,
            endAt: _endAt,
            claimed: <span class="hljs-literal">false</span>
        });

        <span class="hljs-keyword">emit</span> Launch(count, <span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>, _goal, _startAt, _endAt);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cancel</span>(<span class="hljs-params"><span class="hljs-keyword">uint256</span> _id</span>) <span class="hljs-title"><span class="hljs-keyword">external</span></span> </span>{
        Campaign <span class="hljs-keyword">memory</span> campaign <span class="hljs-operator">=</span> campaigns[_id];
        <span class="hljs-built_in">require</span>(campaign.creator <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>, <span class="hljs-string">"not creator"</span>);
        <span class="hljs-built_in">require</span>(<span class="hljs-built_in">block</span>.<span class="hljs-built_in">timestamp</span> <span class="hljs-operator">&lt;</span> campaign.startAt, <span class="hljs-string">"started"</span>);

        <span class="hljs-keyword">delete</span> campaigns[_id];
        <span class="hljs-keyword">emit</span> Cancel(_id);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pledge</span>(<span class="hljs-params"><span class="hljs-keyword">uint256</span> _id, <span class="hljs-keyword">uint256</span> _amount</span>) <span class="hljs-title"><span class="hljs-keyword">external</span></span> </span>{
        Campaign <span class="hljs-keyword">storage</span> campaign <span class="hljs-operator">=</span> campaigns[_id];
        <span class="hljs-built_in">require</span>(<span class="hljs-built_in">block</span>.<span class="hljs-built_in">timestamp</span> <span class="hljs-operator">&gt;</span><span class="hljs-operator">=</span> campaign.startAt, <span class="hljs-string">"not started"</span>);
        <span class="hljs-built_in">require</span>(<span class="hljs-built_in">block</span>.<span class="hljs-built_in">timestamp</span> <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> campaign.endAt, <span class="hljs-string">"ended"</span>);

        campaign.pledged <span class="hljs-operator">+</span><span class="hljs-operator">=</span> _amount;
        pledgedAmount[_id][<span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>] <span class="hljs-operator">+</span><span class="hljs-operator">=</span> _amount;
        token.transferFrom(<span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>, <span class="hljs-keyword">address</span>(<span class="hljs-built_in">this</span>), _amount);

        <span class="hljs-keyword">emit</span> Pledge(_id, <span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>, _amount);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unpledge</span>(<span class="hljs-params"><span class="hljs-keyword">uint256</span> _id, <span class="hljs-keyword">uint256</span> _amount</span>) <span class="hljs-title"><span class="hljs-keyword">external</span></span> </span>{
        Campaign <span class="hljs-keyword">storage</span> campaign <span class="hljs-operator">=</span> campaigns[_id];
        <span class="hljs-built_in">require</span>(<span class="hljs-built_in">block</span>.<span class="hljs-built_in">timestamp</span> <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> campaign.endAt, <span class="hljs-string">"ended"</span>);

        campaign.pledged <span class="hljs-operator">-</span><span class="hljs-operator">=</span> _amount;
        pledgedAmount[_id][<span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>] <span class="hljs-operator">-</span><span class="hljs-operator">=</span> _amount;
        token.<span class="hljs-built_in">transfer</span>(<span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>, _amount);

        <span class="hljs-keyword">emit</span> Unpledge(_id, <span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>, _amount);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">claim</span>(<span class="hljs-params"><span class="hljs-keyword">uint256</span> _id</span>) <span class="hljs-title"><span class="hljs-keyword">external</span></span> </span>{
        Campaign <span class="hljs-keyword">storage</span> campaign <span class="hljs-operator">=</span> campaigns[_id];
        <span class="hljs-built_in">require</span>(campaign.creator <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>, <span class="hljs-string">"not creator"</span>);
        <span class="hljs-built_in">require</span>(<span class="hljs-built_in">block</span>.<span class="hljs-built_in">timestamp</span> <span class="hljs-operator">&gt;</span> campaign.endAt, <span class="hljs-string">"not ended"</span>);
        <span class="hljs-built_in">require</span>(campaign.pledged <span class="hljs-operator">&gt;</span><span class="hljs-operator">=</span> campaign.goal, <span class="hljs-string">"pledged &lt; goal"</span>);
        <span class="hljs-built_in">require</span>(<span class="hljs-operator">!</span>campaign.claimed, <span class="hljs-string">"claimed"</span>);

        campaign.claimed <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
        token.<span class="hljs-built_in">transfer</span>(campaign.creator, campaign.pledged);

        <span class="hljs-keyword">emit</span> Claim(_id);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refund</span>(<span class="hljs-params"><span class="hljs-keyword">uint256</span> _id</span>) <span class="hljs-title"><span class="hljs-keyword">external</span></span> </span>{
        Campaign <span class="hljs-keyword">memory</span> campaign <span class="hljs-operator">=</span> campaigns[_id];
        <span class="hljs-built_in">require</span>(<span class="hljs-built_in">block</span>.<span class="hljs-built_in">timestamp</span> <span class="hljs-operator">&gt;</span> campaign.endAt, <span class="hljs-string">"not ended"</span>);
        <span class="hljs-built_in">require</span>(campaign.pledged <span class="hljs-operator">&lt;</span> campaign.goal, <span class="hljs-string">"pledged &gt;= goal"</span>);

        <span class="hljs-keyword">uint256</span> bal <span class="hljs-operator">=</span> pledgedAmount[_id][<span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>];
        pledgedAmount[_id][<span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>] <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        token.<span class="hljs-built_in">transfer</span>(<span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>, bal);

        <span class="hljs-keyword">emit</span> Refund(_id, <span class="hljs-built_in">msg</span>.<span class="hljs-built_in">sender</span>, bal);
    }
}
</code></pre>`

export default html
